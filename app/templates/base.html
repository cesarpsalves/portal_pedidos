<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}Portal{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>

<body>
    <nav>
        <a href="{{ url_for('main.dashboard') }}">Início</a>

        {% if session.usuario_id %}
        {# Itens visíveis para usuários logados #}

        <span style="margin-left: 10px;">
            <img src="{{ session.usuario_foto or url_for('static', filename='images/default_user.png') }}" alt="Avatar"
                class="user-photo" width="32" height="32" style="vertical-align: middle;" />
            Olá, {{ session.usuario_nome }}
        </span>

        <ul>
            <li><a href="{{ url_for('solicitacoes.lista_solicitacoes') }}">Minhas Solicitações</a></li>

            {% set perfis = session.get("usuario_perfis", "").split(",") %}

            {% if "aprovador" in perfis or "administrador" in perfis or "gerente" in perfis or "diretor" in perfis %}
            <li><a href="{{ url_for('aprovacoes.listar_solicitacoes') }}">Aprovar Solicitações</a></li>
            {% endif %}

            {% if "comprador" in perfis or "administrador" in perfis or "gerente" in perfis or "diretor" in perfis %}
            <li><a href="{{ url_for('compras.lista_compras') }}">Solicitações Aprovadas (Compras)</a></li>
            {% endif %}

            {% if "financeiro" in perfis or "tributario" in perfis %}
            <li><a href="{{ url_for('historico.historico_solicitacoes') }}">Histórico de Solicitações</a></li>
            {% endif %}

            {% if "administrador" in perfis or "gerente" in perfis or "diretor" in perfis %}
            <li><a href="{{ url_for('admin.gerenciar_usuarios') }}">Gerenciar Usuários</a></li>
            {% endif %}

            <li><a href="{{ url_for('profile.view') }}">Meu Perfil</a></li>
            <li><a href="{{ url_for('auth.logout') }}">Sair</a></li>
        </ul>
        {% else %}
        <a href="{{ url_for('auth.login') }}">Login</a>
        {% endif %}
    </nav>

    <hr>
    {% block content %}{% endblock %}
    <hr>

    <footer>
        &copy; {{ ano }} – Portal Grupo KFP
    </footer>
</body>

</html>