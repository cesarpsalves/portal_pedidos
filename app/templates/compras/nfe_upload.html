{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h4>Upload de Nota Fiscal ({{ tipo|capitalize }})</h4>

    <form method="POST" enctype="multipart/form-data" id="nfe-upload-form">
        {{ form.hidden_tag() }}

        <div class="mb-3">
            <label class="form-label">Arraste o PDF aqui ou clique abaixo</label>
            <div id="drop-zone" class="border border-primary rounded bg-light text-center py-4"
                style="cursor: pointer;">
                <i class="bi bi-upload display-4"></i>
                <p>Solte o arquivo aqui ou clique para selecionar</p>
            </div>
            <input type="file" id="arquivo" name="arquivo" accept="application/pdf" class="form-control mt-2 d-none">
        </div>

        <button type="submit" class="btn btn-success w-100">Enviar Nota Fiscal</button>
    </form>
</div>

<script>
    const dropZone = document.getElementById('drop-zone');
    const inputFile = document.getElementById('arquivo');

    dropZone.addEventListener('click', () => inputFile.click());

    dropZone.addEventListener('dragover', e => {
        e.preventDefault();
        dropZone.classList.add('bg-primary', 'text-white');
    });

    dropZone.addEventListener('dragleave', () => {
        dropZone.classList.remove('bg-primary', 'text-white');
    });

    dropZone.addEventListener('drop', e => {
        e.preventDefault();
        dropZone.classList.remove('bg-primary', 'text-white');
        if (e.dataTransfer.files.length > 0) {
            inputFile.files = e.dataTransfer.files;
            document.getElementById('nfe-upload-form').submit();
        }
    });
</script>
{% endblock %}