{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h4 class="mb-3">Anexar Nota Fiscal</h4>
    <form method="POST" enctype="multipart/form-data" action="" class="needs-validation" novalidate>
        {{ form.hidden_tag() }}
        <input type="hidden" name="pacote_id" value="{{ pacote_id }}">
        <div class="form-group mb-3">
            <label>Arquivo PDF</label>
            <div id="drop-area" class="border border-secondary p-4 text-center rounded bg-light">
                <p>Arraste o PDF aqui ou clique para selecionar</p>
                <input type="file" name="arquivo_pdf" id="fileElem" accept=".pdf" style="display:none" required>
                <button type="button" class="btn btn-secondary mt-2"
                    onclick="document.getElementById('fileElem').click();">Selecionar PDF</button>
            </div>
        </div>

        <div class="form-group mb-3">
            <label>Chave de Acesso</label>
            {{ form.chave_acesso(class="form-control", required=True) }}
        </div>

        <button type="submit" class="btn btn-success w-100">Confirmar Anexo</button>
    </form>
</div>

<script>
    const dropArea = document.getElementById("drop-area");
    const fileElem = document.getElementById("fileElem");

    ['dragenter', 'dragover'].forEach(evt => dropArea.addEventListener(evt, e => {
        e.preventDefault();
        e.stopPropagation();
        dropArea.classList.add('border-primary');
    }));

    ['dragleave', 'drop'].forEach(evt => dropArea.addEventListener(evt, e => {
        e.preventDefault();
        e.stopPropagation();
        dropArea.classList.remove('border-primary');
    }));

    dropArea.addEventListener("drop", e => {
        fileElem.files = e.dataTransfer.files;
    });
</script>
{% endblock %}